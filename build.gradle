plugins {
    id 'java'
    id 'org.jetbrains.intellij' version "0.4.16"
}

def localSinceBuild = '201.6668.113'
def localPluginName = 'plugin-intellij'

def versionNum = '1.0.0'
group 'some.company'
version System.getenv("RELEASE") == "true" ? versionNum : versionNum + '-SNAPSHOT' + (System.getenv("SNAPSHOT") ?: "") // Plugin version

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    maven { url 'https://www.jetbrains.com/intellij-repository/releases/' }
}

dependencies {
    testCompile group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.0.0-M4'
}

runIde {
    jvmArgs '-Xmx4G'
}
intellij {
    version '2020.2.1'
    plugins = ['java']
    type 'IU'
    pluginName localPluginName
}

patchPluginXml {
    // documentation: https://github.com/JetBrains/gradle-intellij-plugin
    sinceBuild localSinceBuild
    untilBuild '215.*'
    version versionNum
    sinceBuild localSinceBuild
}